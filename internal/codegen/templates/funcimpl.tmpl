{{if .ExclusiveTo}}{{/*Activate class*/}}
inspectable, err := ole.RoGetActivationFactory("{{.ExclusiveTo.TypeNamespace}}.{{.ExclusiveTo.TypeName}}", ole.NewGUID(GUID{{.FuncOwner}}))
if err != nil {
    return {{if .ReturnParam }}{{.ReturnParam.DefaultValue}}, {{end}}err
}
v := (*{{.FuncOwner}})(unsafe.Pointer(inspectable))

{{end -}}
{{if .ReturnParam -}}var out {{.ReturnParam.Type}}
{{end -}}
hr, _, _ := syscall.SyscallN(
    v.VTable().{{funcName .}},
    // this
    uintptr(unsafe.Pointer(v)),
    {{range .InParams -}}
        // in params
        uintptr({{.Name}}),   // in {{.Name}}
    {{end -}}
    {{if .ReturnParam -}}
        // out params
        uintptr(unsafe.Pointer(&out)), // out {{.ReturnParam.Type}}
    {{end}})


if hr != 0 {
    return {{if .ReturnParam }}{{.ReturnParam.DefaultValue}}, {{end}}ole.NewError(hr)
}

{{if .ReturnParam -}}
return out, nil
{{- else -}}
return nil
{{- end -}}
