{{if .RequiresActivation}}{{/*Activate class*/ -}}
inspectable, err := ole.RoGetActivationFactory("{{.ExclusiveTo}}", ole.NewGUID(GUID{{.FuncOwner}}))
if err != nil {
    return {{range .ReturnParams -}}
        {{.GoDefaultValue}}, {{end}}err
}
v := (*{{.FuncOwner}})(unsafe.Pointer(inspectable))

{{end -}}
{{range .ReturnParams -}}var {{.GoVarName}} {{template "variabletype.tmpl" .}}
{{end -}}
hr, _, _ := syscall.SyscallN(
    v.VTable().{{funcName .}},
    {{- if .RequiresActivation}}
        0, // this is a static func, so there's no this
    {{else}}
        uintptr(unsafe.Pointer(v)), // this
    {{end -}}
    {{range .InParams -}}
        {{if .IsOut -}}
            uintptr(unsafe.Pointer({{.GoVarName}})),   // out {{.GoTypeName}}
        {{else if .Type.IsPointer -}}
            uintptr(unsafe.Pointer({{.GoVarName}})),   // in {{.GoTypeName}}
        {{else if .Type.IsPrimitive -}}
            uintptr({{.GoVarName}}),   // in {{.GoVarName}}
        {{else -}}
            uintptr(unsafe.Pointer(&{{.GoVarName}})),   // in {{.GoVarName}}
        {{end -}}
    {{end -}}
    {{range .ReturnParams -}}
        uintptr(unsafe.Pointer(&{{.GoVarName}})), // out {{.GoTypeName}}
    {{end}})


if hr != 0 {
    return {{range .ReturnParams }}{{.GoDefaultValue}}, {{end}}ole.NewError(hr)
}

return {{range .ReturnParams }}{{.GoVarName}},{{end}} nil
{{- /* remove trailing white space*/ -}}
