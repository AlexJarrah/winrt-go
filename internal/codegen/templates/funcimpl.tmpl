{{if .RequiresActivation}}{{/*Activate class*/ -}}
inspectable, err := ole.RoGetActivationFactory("{{.ExclusiveTo}}", ole.NewGUID(GUID{{.FuncOwner}}))
if err != nil {
    return {{range .ReturnParams -}}
        {{.DefaultValue}}, {{end}}err
}
v := (*{{.FuncOwner}})(unsafe.Pointer(inspectable))

{{end -}}
{{range .ReturnParams -}}var {{.Name}} {{.Type}}
{{end -}}
hr, _, _ := syscall.SyscallN(
    v.VTable().{{funcName .}},
    {{- if .RequiresActivation}}
        0, // this is a static func, so there's no this
    {{else}}
        uintptr(unsafe.Pointer(v)), // this
    {{end -}}
    {{range .InParams -}}
        {{- if .IsPointer -}}
            uintptr(unsafe.Pointer({{.Name}})),   // in {{.Name}}
        {{else -}}
            uintptr(unsafe.Pointer(&{{.Name}})),   // in {{.Name}}
        {{end -}}
    {{end -}}
    {{range .ReturnParams -}}
        uintptr(unsafe.Pointer(&{{.Name}})), // out {{.Type}}
    {{end}})


if hr != 0 {
    return {{range .ReturnParams }}{{.DefaultValue}}, {{end}}ole.NewError(hr)
}

return {{range .ReturnParams }}{{.Name}},{{end}} nil
{{- /* remove trailing white space*/ -}}
