{{if .RequiresActivation}}{{/*Activate class*/ -}}
inspectable, err := ole.RoGetActivationFactory("{{.ExclusiveTo}}", ole.NewGUID(GUID{{.FuncOwner}}))
if err != nil {
    return {{range .ReturnParams -}}
        {{.GoDefaultValue}}, {{end}}err
}
v := (*{{.FuncOwner}})(unsafe.Pointer(inspectable))

{{end -}}
{{range .InParams -}}
    {{ if not .IsOut }}{{continue}}{{ end -}}
    var {{.GoVarName}} {{template "variabletype.tmpl" . -}}
    {{if .Type.IsArray}} = make({{template "variabletype.tmpl" . -}}, {{.GoVarName}}Size){{end}}
{{end -}}
{{range .ReturnParams -}}var {{.GoVarName}} {{template "variabletype.tmpl" .}}
{{end -}}
hr, _, _ := syscall.SyscallN(
    v.VTable().{{funcName .}},
    {{- if .RequiresActivation}}
        0, // this is a static func, so there's no this
    {{else}}
        uintptr(unsafe.Pointer(v)), // this
    {{end -}}
    {{range .InParams -}}
        {{if .IsOut -}}
            {{/* Arrays need to pass a pointer to their first element */ -}}
            uintptr(unsafe.Pointer(&{{.GoVarName}}{{if .Type.IsArray }}[0]{{end}})),   // out {{.GoTypeName}}
        {{else if .Type.IsPointer -}}
            uintptr(unsafe.Pointer({{.GoVarName}})),   // in {{.GoTypeName}}
        {{else if .Type.IsPrimitive -}}
            uintptr({{.GoVarName}}),   // in {{.GoVarName}}
        {{else -}}
            uintptr(unsafe.Pointer(&{{.GoVarName}})),   // in {{.GoVarName}}
        {{end -}}
    {{end -}}
    {{range .ReturnParams -}}
        uintptr(unsafe.Pointer(&{{.GoVarName}})), // out {{.GoTypeName}}
    {{end}})


if hr != 0 {
    return {{range .InParams}}{{if .IsOut}}{{.GoDefaultValue}}, {{end}}{{end -}}
        {{range .ReturnParams }}{{.GoDefaultValue}}, {{end}}ole.NewError(hr)
}

return {{range .InParams}}{{if .IsOut}}{{.GoVarName}}, {{end}}{{end -}}
    {{range .ReturnParams }}{{.GoVarName}},{{end}} nil
{{- /* remove trailing white space*/ -}}
